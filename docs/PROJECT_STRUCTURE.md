# GemRelic é¡¹ç›®ç»“æ„è¯´æ˜

## ğŸ“ é¡¹ç›®ç›®å½•ç»“æ„

```
Minecraft-GemRelic/
â”‚
â”œâ”€â”€ ğŸ“„ pom.xml                                    # Mavenæ„å»ºé…ç½®æ–‡ä»¶
â”œâ”€â”€ ğŸ“„ README.md                                  # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ ğŸ“„ PROJECT_STRUCTURE.md                       # æœ¬æ–‡ä»¶
â”œâ”€â”€ ğŸ“„ .gitignore                                 # Gitå¿½ç•¥æ–‡ä»¶é…ç½®
â”œâ”€â”€ ğŸ“„ plans.md                                   # é¡¹ç›®è®¾è®¡æ–‡æ¡£
â”œâ”€â”€ ğŸ“„ æœ€å°å¯è¿è¡Œæ’ä»¶éª¨æ¶è®¾è®¡æ€è·¯.md                # éª¨æ¶è®¾è®¡æ€è·¯
â”‚
â””â”€â”€ ğŸ“‚ src/main/
    â”œâ”€â”€ ğŸ“‚ java/com/lymc/gemrelic/               # Javaæºä»£ç ç›®å½•
    â”‚   â”‚
    â”‚   â”œâ”€â”€ ğŸ“„ GemRelicPlugin.java               # ğŸ”´ æ’ä»¶ä¸»ç±»
    â”‚   â”‚   â””â”€â”€ èŒè´£ï¼šæ’ä»¶ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€ç»„ä»¶åˆå§‹åŒ–
    â”‚   â”‚
    â”‚   â”œâ”€â”€ ğŸ“‚ model/                             # æ•°æ®æ¨¡å‹å±‚
    â”‚   â”‚   â”œâ”€â”€ ğŸ“„ GemData.java                  # å®çŸ³å®šä¹‰æ•°æ®æ¨¡å‹
    â”‚   â”‚   â”œâ”€â”€ ğŸ“„ GemInstance.java              # å®çŸ³å®ä¾‹æ¨¡å‹
    â”‚   â”‚   â”œâ”€â”€ ğŸ“„ AttributeData.java            # å±æ€§æ•°æ®æ¨¡å‹
    â”‚   â”‚   â””â”€â”€ ğŸ“„ UpgradeConfig.java            # å‡çº§é…ç½®æ¨¡å‹
    â”‚   â”‚
    â”‚   â”œâ”€â”€ ğŸ“‚ manager/                           # ç®¡ç†å™¨å±‚
    â”‚   â”‚   â””â”€â”€ ğŸ“„ GemManager.java               # ğŸ”´ å®çŸ³ç®¡ç†å™¨ï¼ˆæ ¸å¿ƒï¼‰
    â”‚   â”‚       â””â”€â”€ èŒè´£ï¼šé…ç½®åŠ è½½ã€å®çŸ³åˆ›å»ºã€PDCæ•°æ®è¯»å†™
    â”‚   â”‚
    â”‚   â”œâ”€â”€ ğŸ“‚ command/                           # å‘½ä»¤å¤„ç†å±‚
    â”‚   â”‚   â””â”€â”€ ğŸ“„ GemCommand.java               # /gemå‘½ä»¤å¤„ç†å™¨
    â”‚   â”‚       â””â”€â”€ èŒè´£ï¼šå‘½ä»¤è§£æã€Tabè¡¥å…¨ã€æƒé™æ£€æŸ¥
    â”‚   â”‚
    â”‚   â””â”€â”€ ğŸ“‚ listener/                          # äº‹ä»¶ç›‘å¬å±‚
    â”‚       â””â”€â”€ ğŸ“„ PlayerListener.java           # ç©å®¶äº‹ä»¶ç›‘å¬å™¨
    â”‚           â””â”€â”€ èŒè´£ï¼šç©å®¶åŠ å…¥/é€€å‡ºäº‹ä»¶ï¼ˆé¢„ç•™æ‰©å±•ï¼‰
    â”‚
    â””â”€â”€ ğŸ“‚ resources/                             # èµ„æºæ–‡ä»¶ç›®å½•
        â”œâ”€â”€ ğŸ“„ plugin.yml                        # æ’ä»¶æè¿°æ–‡ä»¶ï¼ˆå¿…éœ€ï¼‰
        â”œâ”€â”€ ğŸ“„ config.yml                        # æ’ä»¶ä¸»é…ç½®æ–‡ä»¶
        â””â”€â”€ ğŸ“„ gems.yml                          # å®çŸ³å®šä¹‰é…ç½®æ–‡ä»¶
```

## ğŸ”§ æ ¸å¿ƒç»„ä»¶è¯´æ˜

### 1ï¸âƒ£ æ’ä»¶ä¸»ç±» (GemRelicPlugin.java)

**ç»§æ‰¿å…³ç³»**: `extends JavaPlugin`

**æ ¸å¿ƒæ–¹æ³•**:
- `onEnable()` - æ’ä»¶å¯åŠ¨æ—¶æ‰§è¡Œ
- `onDisable()` - æ’ä»¶å…³é—­æ—¶æ‰§è¡Œ
- `reloadPluginConfig()` - é‡è½½é…ç½®

**åˆå§‹åŒ–æµç¨‹**:
```
onEnable()
  â”œâ”€â”€ åˆ›å»ºæ•°æ®æ–‡ä»¶å¤¹
  â”œâ”€â”€ ä¿å­˜é»˜è®¤é…ç½®
  â”œâ”€â”€ åˆå§‹åŒ– GemManager
  â”œâ”€â”€ æ³¨å†Œå‘½ä»¤å¤„ç†å™¨
  â””â”€â”€ æ³¨å†Œäº‹ä»¶ç›‘å¬å™¨
```

### 2ï¸âƒ£ æ•°æ®æ¨¡å‹å±‚ (model/)

#### GemDataï¼ˆå®çŸ³å®šä¹‰ï¼‰
- ä»é…ç½®æ–‡ä»¶åŠ è½½çš„å®çŸ³æ¨¡æ¿
- åŒ…å«ï¼šIDã€æè´¨ã€æ˜¾ç¤ºåç§°ã€å±æ€§æ± ã€å‡çº§é…ç½®
- ä¸å¯å˜å¯¹è±¡ï¼Œçº¿ç¨‹å®‰å…¨

#### GemInstanceï¼ˆå®çŸ³å®ä¾‹ï¼‰
- ä»£è¡¨å…·ä½“çš„å®çŸ³ç‰©å“
- åŒ…å«ï¼šå®çŸ³ç±»å‹ã€ç­‰çº§ã€å®é™…å±æ€§å€¼
- å¯å˜å¯¹è±¡ï¼Œæ”¯æŒå±æ€§ä¿®æ”¹å’Œå‡çº§

#### AttributeDataï¼ˆå±æ€§å®šä¹‰ï¼‰
- å®šä¹‰å±æ€§çš„ç±»å‹ã€åç§°å’Œæ•°å€¼èŒƒå›´
- æä¾›éšæœºå±æ€§å€¼ç”Ÿæˆæ–¹æ³•

#### UpgradeConfigï¼ˆå‡çº§é…ç½®ï¼‰
- å®šä¹‰å‡çº§æ‰€éœ€ææ–™ã€æˆåŠŸç‡ã€æˆé•¿å€ç‡
- ç”¨äºåç»­å‡çº§ç³»ç»Ÿæ‰©å±•

### 3ï¸âƒ£ å®çŸ³ç®¡ç†å™¨ (GemManager.java)

**æ ¸å¿ƒåŠŸèƒ½**:
- âœ… ä» `gems.yml` åŠ è½½å®çŸ³å®šä¹‰
- âœ… åˆ›å»ºå¸¦æœ‰éšæœºå±æ€§çš„å®çŸ³ç‰©å“
- âœ… ä½¿ç”¨ PersistentDataContainer å­˜å‚¨å®çŸ³æ•°æ®
- âœ… ä» ItemStack è¯»å–å®çŸ³ä¿¡æ¯
- âœ… æ”¯æŒçƒ­é‡è½½é…ç½®

**PDC æ•°æ®ç»“æ„**:
```
NamespacedKey: gemrelic:gem_type      -> String  (å®çŸ³ç±»å‹ID)
NamespacedKey: gemrelic:gem_level     -> Integer (å®çŸ³ç­‰çº§)
NamespacedKey: gemrelic:gem_attributes -> String  (å±æ€§åºåˆ—åŒ–å­—ç¬¦ä¸²)
```

**å±æ€§åºåˆ—åŒ–æ ¼å¼**:
```
"attack:5.2;defense:8.1;crit_rate:3.5"
```

### 4ï¸âƒ£ å‘½ä»¤å¤„ç†å™¨ (GemCommand.java)

**å®ç°æ¥å£**: `CommandExecutor`, `TabCompleter`

**å­å‘½ä»¤**:
| å‘½ä»¤ | æƒé™ | è¯´æ˜ |
|------|------|------|
| `/gem give <ç©å®¶> <ç±»å‹> [ç­‰çº§]` | `gemrelic.command.gem.give` | ç»™äºˆå®çŸ³ |
| `/gem info` | - | æŸ¥çœ‹æ‰‹æŒå®çŸ³ä¿¡æ¯ |
| `/gem list` | - | åˆ—å‡ºæ‰€æœ‰å®çŸ³ç±»å‹ |
| `/gem reload` | `gemrelic.admin` | é‡è½½é…ç½® |
| `/gem help` | - | æ˜¾ç¤ºå¸®åŠ© |

**Tabè¡¥å…¨æ”¯æŒ**:
- ç¬¬1å‚æ•°ï¼šå­å‘½ä»¤è¡¥å…¨
- ç¬¬2å‚æ•°ï¼ˆgiveï¼‰ï¼šåœ¨çº¿ç©å®¶è¡¥å…¨
- ç¬¬3å‚æ•°ï¼ˆgiveï¼‰ï¼šå®çŸ³ç±»å‹è¡¥å…¨
- ç¬¬4å‚æ•°ï¼ˆgiveï¼‰ï¼šç­‰çº§å»ºè®®

### 5ï¸âƒ£ äº‹ä»¶ç›‘å¬å™¨ (PlayerListener.java)

**å½“å‰ç›‘å¬äº‹ä»¶**:
- `PlayerJoinEvent` - ç©å®¶åŠ å…¥ï¼ˆç›®å‰ä»…æ—¥å¿—ï¼‰
- `PlayerQuitEvent` - ç©å®¶é€€å‡ºï¼ˆç›®å‰ä»…æ—¥å¿—ï¼‰

**é¢„ç•™æ‰©å±•**:
- `EntityDamageByEntityEvent` - æ”»å‡»ä¼¤å®³åŠ æˆ
- `EntityDamageEvent` - é˜²å¾¡åŠ æˆ
- `PlayerInteractEvent` - å®çŸ³é•¶åµŒäº¤äº’
- `InventoryClickEvent` - GUIç‚¹å‡»äº‹ä»¶

## ğŸ“‹ é…ç½®æ–‡ä»¶è¯´æ˜

### plugin.yml
```yaml
name: GemRelic              # æ’ä»¶åç§°
version: 1.0.0              # æ’ä»¶ç‰ˆæœ¬
main: com.lymc.gemrelic.GemRelicPlugin  # ä¸»ç±»è·¯å¾„
api-version: '1.20'         # APIç‰ˆæœ¬
commands:                   # å‘½ä»¤å®šä¹‰
  gem: ...                  
permissions:                # æƒé™å®šä¹‰
  gemrelic.command.gem: ...
```

### gems.yml
```yaml
gems:
  ruby:                     # å®çŸ³ID
    material: REDSTONE      # ç‰©å“æè´¨
    display: "Â§cçº¢å®çŸ³"     # æ˜¾ç¤ºåç§°
    lore: [...]            # ç‰©å“æè¿°
    attributes:            # å±æ€§æ± 
      - type: "attack"
        name: "æ”»å‡»åŠ›"
        min: 2.0
        max: 6.0
    upgrade:               # å‡çº§é…ç½®
      cost_material: DIAMOND
      cost_amount: 1
      success_chance: 0.8
      growth_rate: 1.2
```

### config.yml
```yaml
settings:                  # æ’ä»¶è®¾ç½®
  debug: false
  language: zh_CN
gem:                       # å®çŸ³ç³»ç»Ÿè®¾ç½®
  max_level: 100
  lose_gem_on_fail: false
socket:                    # é•¶åµŒç³»ç»Ÿè®¾ç½®ï¼ˆé¢„ç•™ï¼‰
  max_slots: 3
  allow_remove: true
attribute:                 # å±æ€§ç³»ç»Ÿè®¾ç½®ï¼ˆé¢„ç•™ï¼‰
  enabled: true
  calculation_mode: additive
messages:                  # æ¶ˆæ¯é…ç½®
  prefix: "Â§6[GemRelic]Â§r "
```

## ğŸ”‘ å…³é”®è®¾è®¡æ¨¡å¼

### 1. å•ä¾‹æ¨¡å¼
```java
// GemRelicPlugin ä½¿ç”¨å•ä¾‹æ¨¡å¼
private static GemRelicPlugin instance;
public static GemRelicPlugin getInstance() {
    return instance;
}
```

### 2. ç®¡ç†å™¨æ¨¡å¼
- æ¯ä¸ªåŠŸèƒ½æ¨¡å—éƒ½æœ‰å¯¹åº”çš„ Manager
- Manager è´Ÿè´£è¯¥æ¨¡å—çš„æ•°æ®åŠ è½½ã€ä¸šåŠ¡é€»è¾‘
- é€šè¿‡æ’ä»¶ä¸»ç±»è·å– Manager å®ä¾‹

### 3. æ•°æ®ä¼ è¾“å¯¹è±¡ (DTO)
- GemDataã€GemInstance ç­‰éƒ½æ˜¯çº¯æ•°æ®å¯¹è±¡
- å°è£…æ•°æ®ï¼Œæä¾› getter/setter
- ä¸åŒ…å«ä¸šåŠ¡é€»è¾‘

### 4. å‘½ä»¤-å¤„ç†å™¨æ¨¡å¼
- æ¯ä¸ªå‘½ä»¤éƒ½æœ‰ç‹¬ç«‹çš„å¤„ç†æ–¹æ³•
- é€šè¿‡ switch-case åˆ†å‘åˆ°å¯¹åº”çš„å¤„ç†å™¨
- ä¾¿äºæ‰©å±•æ–°çš„å­å‘½ä»¤

## ğŸ“Š æ•°æ®æµå›¾

### å®çŸ³åˆ›å»ºæµç¨‹
```
ç©å®¶æ‰§è¡Œå‘½ä»¤ â†’ GemCommand.handleGive()
                    â†“
            GemManager.createGem()
                    â†“
            è¯»å– GemDataï¼ˆé…ç½®ï¼‰
                    â†“
            éšæœºç”Ÿæˆå±æ€§å€¼
                    â†“
            åˆ›å»º GemInstance
                    â†“
            åºåˆ—åŒ–åˆ° PDC
                    â†“
            ç”Ÿæˆ ItemStack
                    â†“
            ç»™äºˆç©å®¶
```

### å®çŸ³ä¿¡æ¯è¯»å–æµç¨‹
```
ç©å®¶æ‰‹æŒç‰©å“ â†’ GemCommand.handleInfo()
                    â†“
            GemManager.isGem()
                    â†“
            è¯»å– PDC æ•°æ®
                    â†“
            ååºåˆ—åŒ–å±æ€§
                    â†“
            åˆ›å»º GemInstance
                    â†“
            æ˜¾ç¤ºä¿¡æ¯ç»™ç©å®¶
```

## ğŸš€ ç¼–è¯‘ä¸éƒ¨ç½²

### ç¼–è¯‘å‘½ä»¤
```bash
mvn clean package
```

### è¾“å‡ºä½ç½®
```
target/gemrelic-1.0.0.jar
```

### éƒ¨ç½²æ­¥éª¤
1. å°† jar æ–‡ä»¶æ”¾å…¥æœåŠ¡å™¨ `plugins/` ç›®å½•
2. é‡å¯æœåŠ¡å™¨æˆ–ä½¿ç”¨æ’ä»¶åŠ è½½å™¨
3. é…ç½®æ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆåˆ° `plugins/GemRelic/`

## ğŸ“ˆ åç»­æ‰©å±•æ–¹å‘

### çŸ­æœŸç›®æ ‡
1. âœ… å®çŸ³åŸºç¡€ç³»ç»Ÿ
2. ğŸ”² å®çŸ³å‡çº§åŠŸèƒ½
3. ğŸ”² å®çŸ³é•¶åµŒGUI
4. ğŸ”² å±æ€§åŠ æˆç³»ç»Ÿ

### ä¸­æœŸç›®æ ‡
1. ğŸ”² è£…å¤‡æ§½ä½ç³»ç»Ÿ
2. ğŸ”² é•¶åµŒ/æ‹†å¸åŠŸèƒ½
3. ğŸ”² å¥—è£…æ•ˆæœ
4. ğŸ”² æ•°æ®æŒä¹…åŒ–ï¼ˆSQLite/MySQLï¼‰

### é•¿æœŸç›®æ ‡
1. ğŸ”² PlaceholderAPI é›†æˆ
2. ğŸ”² å¤šè¯­è¨€æ”¯æŒ
3. ğŸ”² ç»æµç³»ç»Ÿé›†æˆ
4. ğŸ”² è‡ªå®šä¹‰æ¨¡å‹ï¼ˆResourcePackï¼‰

## ğŸ¯ ä»£ç è§„èŒƒæ£€æŸ¥æ¸…å•

- âœ… æ‰€æœ‰å…¬å…±æ–¹æ³•éƒ½æœ‰ JavaDoc æ³¨é‡Š
- âœ… ä½¿ç”¨ PersistentDataContainer å­˜å‚¨æ•°æ®
- âœ… é…ç½®æ–‡ä»¶æ”¯æŒçƒ­é‡è½½
- âœ… å®Œæ•´çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•
- âœ… å‘½ä»¤æƒé™æ£€æŸ¥
- âœ… Tab è¡¥å…¨å®ç°
- âœ… éµå¾ª Paper API æœ€ä½³å®è·µ
- âœ… æ¨¡å—åŒ–è®¾è®¡ï¼Œä½è€¦åˆé«˜å†…èš

## ğŸ“ ç»´æŠ¤å»ºè®®

1. **å®šæœŸæ›´æ–°ä¾èµ–**: æ£€æŸ¥ Paper API ç‰ˆæœ¬æ›´æ–°
2. **æ€§èƒ½ä¼˜åŒ–**: ç›‘æ§ PDC è¯»å†™æ€§èƒ½
3. **é…ç½®éªŒè¯**: æ·»åŠ é…ç½®æ–‡ä»¶åˆæ³•æ€§æ£€æŸ¥
4. **å•å…ƒæµ‹è¯•**: ä¸ºæ ¸å¿ƒé€»è¾‘æ·»åŠ æµ‹è¯•ç”¨ä¾‹
5. **æ–‡æ¡£æ›´æ–°**: ä¿æŒæ–‡æ¡£ä¸ä»£ç åŒæ­¥

---

**åˆ›å»ºæ—¶é—´**: 2025-10-03  
**æ’ä»¶ç‰ˆæœ¬**: 1.0.0  
**æœ€åæ›´æ–°**: 2025-10-03

