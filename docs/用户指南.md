# GemRelic 用户指南

![Minecraft](https://img.shields.io/badge/Minecraft-1.20.x-green)
![Paper](https://img.shields.io/badge/Paper-1.20.x-blue)
![Java](https://img.shields.io/badge/Java-17-orange)

## 📖 目录

- [插件介绍](#插件介绍)
- [安装指南](#安装指南)
- [快速开始](#快速开始)
- [命令使用](#命令使用)
- [权限配置](#权限配置)
- [宝石系统](#宝石系统)
- [配置说明](#配置说明)
- [使用示例](#使用示例)
- [常见问题](#常见问题)

---

## 🎮 插件介绍

**GemRelic** 是一个为 Minecraft Paper 1.20.x 服务器设计的宝石镶嵌与属性系统插件，灵感来源于原神的圣遗物系统。

### 主要特性

✅ **宝石系统**
- 多种宝石类型（红宝石、蓝宝石、翡翠、钻石宝石）
- 随机属性生成系统
- 宝石等级系统（1-100级）
- 使用 PersistentDataContainer 安全存储数据

✅ **命令系统**
- 完整的管理命令集
- 智能 Tab 补全
- 详细的帮助信息

✅ **配置系统**
- 热重载支持
- 灵活的宝石配置
- 多语言消息支持

---

## 🔧 安装指南

### 系统要求

- **服务器核心**: Paper 1.20.x 或更高版本
- **Java版本**: Java 17 或更高版本
- **服务器RAM**: 建议至少 2GB

### 安装步骤

1. **下载插件**
   ```
   从 Releases 页面下载 gemrelic-1.0.0.jar
   ```

2. **部署插件**
   ```
   将 jar 文件放入服务器的 plugins/ 目录
   ```

3. **启动服务器**
   ```
   重启服务器或使用插件管理器加载
   ```

4. **验证安装**
   ```
   在控制台或游戏中输入 /gemrelic help
   如果显示帮助信息，说明安装成功
   ```

### 自动生成的文件

安装成功后，插件会在 `plugins/GemRelic/` 目录下生成：

```
plugins/GemRelic/
├── config.yml        # 主配置文件
└── gems.yml          # 宝石定义文件
```

---

## 🚀 快速开始

### 第一步：熟悉命令

所有命令都以 `/gemrelic` 开头，输入后按 **Tab** 键可以自动补全：

```bash
/gemrelic help         # 查看帮助
/gemrelic list         # 查看可用宝石类型
```

### 第二步：获得你的第一颗宝石

```bash
# 给自己一颗1级红宝石
/gemrelic give <你的用户名> ruby 1
```

### 第三步：查看宝石信息

```bash
# 手持宝石，然后输入
/gemrelic info
```

你会看到宝石的详细属性信息！

---

## ⌨️ 命令使用

### 命令格式

所有命令都使用 `/gemrelic` 作为主命令，支持以下子命令：

| 命令 | 用法 | 说明 | 权限 |
|------|------|------|------|
| `help` | `/gemrelic help` | 显示帮助信息 | `gemrelic.command.gemrelic` |
| `give` | `/gemrelic give <玩家> <宝石类型> [等级]` | 给予玩家宝石 | `gemrelic.command.gemrelic.give` |
| `info` | `/gemrelic info` | 查看手持宝石信息 | `gemrelic.command.gemrelic` |
| `list` | `/gemrelic list` | 列出所有宝石类型 | `gemrelic.command.gemrelic` |
| `reload` | `/gemrelic reload` | 重载插件配置 | `gemrelic.admin` |

### 详细说明

#### 1. 给予宝石 (`give`)

**语法**：`/gemrelic give <玩家名> <宝石类型> [等级]`

**参数说明**：
- `<玩家名>`: 目标玩家的用户名（必填）
- `<宝石类型>`: 宝石类型ID（必填）
- `[等级]`: 宝石等级，1-100，默认为1（可选）

**示例**：
```bash
# 给玩家 Steve 一颗1级红宝石
/gemrelic give Steve ruby

# 给玩家 Alex 一颗10级钻石宝石
/gemrelic give Alex diamond_gem 10
```

#### 2. 查看信息 (`info`)

**语法**：`/gemrelic info`

**使用方法**：
1. 手持一个宝石物品
2. 输入命令
3. 查看详细的宝石属性信息

**显示内容**：
- 宝石类型
- 宝石等级
- 所有属性及其数值

#### 3. 列出宝石类型 (`list`)

**语法**：`/gemrelic list`

显示服务器上所有可用的宝石类型，包括：
- ruby (红宝石)
- sapphire (蓝宝石)
- emerald (翡翠)
- diamond_gem (钻石宝石)

#### 4. 重载配置 (`reload`)

**语法**：`/gemrelic reload`

**功能**：
- 重新加载 config.yml 配置
- 重新加载 gems.yml 宝石定义
- 刷新所有缓存数据

**注意**：需要管理员权限

---

## 🔐 权限配置

### 权限节点表

| 权限节点 | 默认值 | 说明 |
|----------|---------|------|
| `gemrelic.command.gemrelic` | OP | 基础命令权限 |
| `gemrelic.command.gemrelic.give` | OP | 给予宝石权限 |
| `gemrelic.command.gemrelic.upgrade` | true | 宝石升级权限（未来功能） |
| `gemrelic.admin` | OP | 管理员权限（包含所有权限） |

### 权限配置示例

#### 使用 LuckPerms

```bash
# 给予玩家基础使用权限
/lp user <玩家名> permission set gemrelic.command.gemrelic true

# 给予管理员完整权限
/lp user <管理员> permission set gemrelic.admin true

# 给予组权限
/lp group default permission set gemrelic.command.gemrelic true
```

#### 使用 PermissionsEx

```yaml
groups:
  default:
    permissions:
      - gemrelic.command.gemrelic
  admin:
    permissions:
      - gemrelic.admin
```

---

## 💎 宝石系统

### 宝石类型

#### 🔴 红宝石 (Ruby)
- **材质**: 红石粉
- **主要属性**: 攻击力、暴击率
- **特点**: 适合近战职业
- **属性范围**:
  - 攻击力: 2.0 - 6.0
  - 暴击率: 1.0 - 5.0

#### 🔵 蓝宝石 (Sapphire)  
- **材质**: 青金石
- **主要属性**: 防御力、生命值
- **特点**: 适合坦克职业
- **属性范围**:
  - 防御力: 3.0 - 8.0
  - 生命值: 2.0 - 6.0

#### 🟢 翡翠 (Emerald)
- **材质**: 绿宝石
- **主要属性**: 生命恢复、生命值
- **特点**: 适合辅助职业
- **属性范围**:
  - 生命恢复: 1.0 - 3.0
  - 生命值: 4.0 - 10.0

#### 💎 钻石宝石 (Diamond Gem)
- **材质**: 钻石
- **主要属性**: 攻击力、防御力、暴击率
- **特点**: 全能型宝石，属性全面
- **属性范围**:
  - 攻击力: 4.0 - 10.0
  - 防御力: 4.0 - 10.0
  - 暴击率: 2.0 - 8.0

### 宝石等级系统

- **等级范围**: 1-100级
- **等级影响**: 
  - 宝石等级越高，属性数值越大
  - 高等级宝石拥有更好的属性加成
  - 升级系统（规划中）将允许提升宝石等级

### 属性系统

每颗宝石都有随机生成的属性：

- **攻击力 (attack)**: 增加玩家攻击伤害
- **防御力 (defense)**: 增加玩家防御能力  
- **生命值 (health)**: 增加玩家最大生命值
- **暴击率 (crit_rate)**: 增加暴击概率
- **生命恢复 (health_regen)**: 增加生命恢复速度

---

## ⚙️ 配置说明

### config.yml 配置详解

```yaml
# 插件基本设置
settings:
  debug: false                    # 调试模式
  language: zh_CN                 # 语言设置
  send_welcome_message: false     # 是否发送欢迎消息

# 宝石系统设置
gem:
  max_level: 100                  # 宝石最大等级
  lose_gem_on_fail: false         # 升级失败时是否损失宝石
  keep_material_on_fail: false    # 升级失败时是否保留材料

# 镶嵌系统设置（未来功能）
socket:
  max_slots: 3                    # 装备最大槽位数
  allow_remove: true              # 是否允许卸下宝石
  remove_cost_enabled: false      # 卸下宝石是否需要消耗

# 属性系统设置（未来功能）
attribute:
  enabled: true                   # 启用属性加成
  calculation_mode: additive      # 计算模式：加法/乘法

# 消息配置
messages:
  prefix: "§6[GemRelic]§r "       # 消息前缀
  no_permission: "§c你没有权限执行此操作！"
  reload_success: "§a配置重载成功！"
  gem_received: "§a你获得了一颗宝石！"
  gem_upgrade_success: "§a宝石升级成功！"
  gem_upgrade_fail: "§c宝石升级失败！"
```

### gems.yml 配置详解

```yaml
gems:
  ruby:                           # 宝石ID
    material: REDSTONE            # Minecraft材质
    display: "§c红宝石"           # 显示名称
    lore:                         # 描述文本
      - "§7一颗闪耀着红色光芒的宝石"
      - "§7可以为装备增加攻击属性"
    attributes:                   # 属性池
      - type: "attack"            # 属性类型
        name: "攻击力"            # 属性显示名
        min: 2.0                  # 最小值
        max: 6.0                  # 最大值
    upgrade:                      # 升级配置（未来功能）
      cost_material: DIAMOND      # 升级材料
      cost_amount: 1              # 材料数量
      success_chance: 0.8         # 成功率
      growth_rate: 1.2            # 成长倍率
```

---

## 📝 使用示例

### 场景1：服务器管理员分发宝石

```bash
# 给所有在线玩家发放新手宝石包
/gemrelic give Steve ruby 1
/gemrelic give Alex sapphire 1  
/gemrelic give Bob emerald 1
/gemrelic give Alice diamond_gem 1
```

### 场景2：玩家查看宝石属性

```bash
# 玩家手持宝石查看信息
/gemrelic info

# 输出示例：
========== 宝石信息 ==========
宝石类型: ruby
宝石等级: 5
属性:
  - 攻击力: 4.25
  - 暴击率: 3.87
============================
```

### 场景3：管理员管理服务器

```bash
# 查看所有可用宝石类型
/gemrelic list

# 重载配置（修改配置文件后）
/gemrelic reload

# 给高级玩家高等级宝石
/gemrelic give VIPPlayer diamond_gem 50
```

### 场景4：批量操作脚本

如果你是服务器管理员，可以创建脚本批量操作：

```bash
# 创建 gem_starter_pack.txt
/gemrelic give %player% ruby 1
/gemrelic give %player% sapphire 1
/gemrelic give %player% emerald 1

# 使用控制台插件执行批量命令
```

---

## ❓ 常见问题

### Q: 为什么我无法使用 `/gemrelic` 命令？

**A**: 可能的原因：
1. **权限不足** - 确保你有 `gemrelic.command.gemrelic` 权限
2. **插件未加载** - 在控制台输入 `/plugins` 检查插件是否显示绿色
3. **命令拼写错误** - 确保使用 `/gemrelic` 而不是 `/gem`

### Q: 宝石属性为什么每次都不同？

**A**: 这是设计特性！每颗宝石的属性都是在配置的范围内随机生成的，这增加了游戏的趣味性和收集价值。

### Q: 如何修改宝石的属性范围？

**A**: 编辑 `plugins/GemRelic/gems.yml` 文件中对应宝石的 `min` 和 `max` 值，然后使用 `/gemrelic reload` 重载配置。

### Q: 为什么 `/gemrelic give` 命令无效？

**A**: 请检查：
1. 你是否有 `gemrelic.command.gemrelic.give` 权限
2. 目标玩家是否在线
3. 宝石类型是否存在（使用 `/gemrelic list` 查看）
4. 等级是否在 1-100 范围内

### Q: 宝石数据会丢失吗？

**A**: 不会！插件使用 PersistentDataContainer (PDC) 技术，宝石数据直接存储在物品中，即使服务器重启或插件重载，数据也不会丢失。

### Q: 如何添加新的宝石类型？

**A**: 编辑 `plugins/GemRelic/gems.yml` 文件：

```yaml
gems:
  # 添加新宝石
  new_gem:
    material: QUARTZ
    display: "§f新宝石"
    lore:
      - "§7这是一颗新的宝石"
    attributes:
      - type: "new_attribute"
        name: "新属性"
        min: 1.0
        max: 5.0
```

然后使用 `/gemrelic reload` 重载配置。

### Q: 插件支持哪些 Minecraft 版本？

**A**: 目前支持 Paper 1.20.x 版本。对于其他版本的支持正在开发中。

### Q: 宝石升级功能什么时候推出？

**A**: 宝石升级功能正在开发中，将在未来的版本中推出。届时你可以使用升级材料来提升宝石等级和属性。

### Q: 如何备份宝石数据？

**A**: 由于宝石数据存储在物品中，只需要定期备份玩家数据和世界文件即可。建议使用自动备份插件。

---

## 🔗 相关链接

- [项目主页](../../)
- [问题反馈](../../issues)
- [功能建议](../../discussions)
- [开发文档](docs/PROJECT_STRUCTURE.md)

---

## 📞 技术支持

如果你在使用过程中遇到问题，可以通过以下方式获得帮助：

1. **查看日志** - 检查 `logs/latest.log` 中的错误信息
2. **提交 Issue** - 在 GitHub 上报告问题
3. **社区讨论** - 在 Discussions 中与其他用户交流

---

**版本**: 1.0.0  
**最后更新**: 2025-10-04  
**作者**: LYMC

---

> 感谢使用 GemRelic！如果这个插件对你有帮助，请考虑给项目点个 ⭐ Star！
